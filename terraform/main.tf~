resource "aws_iam_group" "developers" {
  name = "developers"
}
resource "aws_iam_group_membership" "team" {
  name = "developers"
  users = [aws_iam_user.bradley.name,
    aws_iam_user.marcus.name,
    aws_iam_user.minh_vu.name,
    aws_iam_user.michelle.name,
    aws_iam_user.jennifer.name,
  aws_iam_user.elizabeth.name]

  group = aws_iam_group.developers.name
}

resource "aws_iam_user" "bradley" {
  name = "bradley"
}

resource "aws_iam_user" "marcus" {
  name = "marcus"
}

resource "aws_iam_user" "minh_vu" {
  name = "minh_vu"
}
resource "aws_iam_user" "michelle" {
  name = "michelle"
}
resource "aws_iam_user" "jennifer" {
  name = "jennifer"
}
resource "aws_iam_user" "elizabeth" {
  name = "elizabeth"
}
resource "aws_iam_policy" "policy" {
  name        = "developer-policy"
  description = "Policy for all developers in g1t1"
  policy = jsonencode(
    {
      "Version" : "2012-10-17",
      "Statement" : [
        {
          "Sid" : "VisualEditor0",
          "Effect" : "Allow",
          "Action" : [
            "rds:*",
            "cloudtrail:*",
            "dynamodb:*",
            "sqs:*",
            "rolesanywhere:*",
            "cloudfront:*",
            "access-analyzer:*",
            "kms:*",
            "kinesis:*",
            "events:*",
            "sns:*",
            "states:*",
            "rds-db:*",
            "cognito-identity:*",
            "dax:*",
            "s3:*",
            "apigateway:*",
            "rds-data:*",
            "appsync:*",
            "amplifybackend:*",
            "iam:*",
            "cloudwatch:*",
            "lambda:*",
            "route53:*",
            "cognito-idp:*"
          ],
          "Resource" : "*"
        }
      ]
    }
  )
}

resource "aws_iam_group_policy_attachment" "for-developers" {
  group      = aws_iam_group.developers.name
  policy_arn = aws_iam_policy.policy.arn
}

